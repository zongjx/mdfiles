***
**组号**：第100组  
**小组成员**：张玫  张彦雯  宗嘉希  周禅城   
**分工**：  
宗嘉希：编写代码（抛飞部分），进行试飞 ，撰写报告，维修飞机  
张玫：编写代码（一键起飞），拍摄试飞视频 ，撰写报告，后期视频剪辑  
张彦雯：编写代码（一键翻滚部分），拍摄试飞视频  
周禅城：拍摄试飞视频，后期视频剪辑  
***
**实现的功能数**：3   
**实现的功能**：  
实现抛飞后平稳降落，需要根据抛飞的力度实现上升不同高度  
实现一键起飞以及平稳降落  
实现翻滚
  
***  
## 功能1：抛飞
* **思路**：  
要实现抛飞的话那应该思考两个过程----抛前和抛后。抛前，飞机拿在手中，电机的状态应该是不转的。抛后是指飞机抛离手直至掉到地上这一段时间，因此我们要在这一段时间启动飞机的电机，使飞机顺利在空中启动并且保持飞行状态。因此我们决定使用飞机锁定和解锁的特性，来使飞机在抛后这一段时间启动电机。当飞机在空中的时候会有一段时间是失重的，若此时飞机是平行与地面并且是正放的，那么飞机上面的加速度传感器三个方向上的理论值都为0，把这个作为飞机的一个解锁条件，时刻读取加速度传感器的值。抛前先把飞机锁定，油门调至足以让飞机起飞的值，再向前抛出飞机，当飞机符合上述解锁条件的时候，就会解锁并且起飞，实现抛飞。
* **修改的文件**：  
FTC_FlyControl.cpp   line:184 ~ 207  
FTC_Scheduler.cpp   line:25 ~ 27  
FTC_IMU.cpp    line:37 ~ 42
***
## 功能2：一键起飞
* **思路**：  
当按下按钮的那一瞬间，会有一个AUX值从1100升到1500，那么这一个可以用于判断是否按下了按钮（虽然那个按钮不太好使），当按钮按下后，把油门的值自动变成足以让飞机起飞的值，然后让油门值不停衰减，衰减至使飞机能够平稳飞行。显然这一个思路是要经过很多次的测试才能够找出各种合适的数据，因此为了让飞机能够保持在一个可控制的范围内，并且能够尽量平稳的飞行，起飞后衰减的速度需要调整，衰减后的最终速度也需要多次调整。然而，由于我们的遥控器出现了一点小问题，导致那两个AUX按钮用不了，所以我们决换另外一种方法去表达：使用油门摇杆去代替按钮。当摇杆的值超过某一个值的时候，就把飞机的油门调到足以让飞机起飞的值，然后逐步衰减至使飞机能够平稳飞行。我们把这个临界值设定为1250，当摇杆的值小于1250的时候，飞机不起飞；当摇杆的值由小于1250变化到大于1250的时候，飞机的油门值瞬间变为1800，然后每隔2ms减1。
* **修改的文件**：  
FTC_FlyControl.cpp   line:104 ~ 142  
***
## 功能3：一键翻滚
* **思路**：
按钮的思路如上面一键起飞一样，用那个AUX值来判断。当按钮按下以后，停掉一个电机的转动，此时由于飞机受力不均匀，会不停地向停止转动的那个电机的方向做翻滚运动，当第一次翻滚的时候，翻滚了1800度的时刻，飞机回向地面方向飞行，此时受到向下的加速度，以此作为判断条件，打开关掉的电机，并且稍微加大转速，然后逐渐衰减至关闭该电机前的速度，飞机因为惯性继续翻滚至向上飞行的方向，如果幸运的话飞机就能恢复原来的飞行状态，不然就翻机。然而因为遥控坏了，没有办法按到那个按钮，我们只完成了代码部分，没有进行试飞。
* **修改的文件**：  
FTC_FlyControl.cpp   line:149 ~ 180  
FTC_IMU.cpp    line:45 ~ 50
***
* **注意**：我们只上交一个工程，如果需要烧录我们的代码进行试飞，那么就要把FTC_FlyControl.cpp文件中三个内环函数分别取消注释，你懂的！
***
***
## 感想  
* **宗嘉希**：总的来说这一次的实训还是挺有意思的。开始的时候我还以为我们能够做什么高大上的飞机，结果看到的飞机却只是一块电路板，确实让我感到挺失望的。没想到在之后的几天里我们利用这个小飞机学到了挺多的东西，比如说各种飞机飞行的原理和理论知识，各种算法。虽然这些东西我们是学了一下，但是感觉挺可惜的我并不能完全消化。万幸最后的大作业并没有太难，我们小组的成员一起合作来完成这个作业，过程还是很开心的。不过说到这个过程就十分的不堪回首了，遇到的困难实在是太多太多了。飞机经常坏掉，于是就要自己去修，甚至还要借别人的飞机；有时在试飞的时候飞机失控，摔了会感到很心痛；试飞不成功的话就要调整代码，调节参数，再继续试飞......这一个过程实在是煎熬。不过最后我们还是排除万难，磕磕碰碰地完成了，真的是太累了。嘿嘿，我会珍惜这个飞机的尸体的。
* **张玫**：实训每天都能看一些视频学一点飞行器的知识，全组一起完成当天布置的任务，过程还是很欢乐的，不过少不了TA大大们一次次的纠错完善。暑假幸好有很负责的组员把飞机带回家，完成了一大半~ 虽然最后一天看到任务要求，觉得难度突然上升了好几个等级，还好一切还算顺利。试飞过程也算是踏过了学校的每一处草地了，每周的空闲时间也都献给了它，因为实训第一天就自作聪明把六个电机都用502粘紧了，导致试飞过程问题不断。后来有幸借到了别人的飞机，才知道飞机与飞机之间是有差别的。有时候不是飞控手的错，不是代码的错，而是飞机本身的错。用别人的飞机不论怎么抛都能稳稳地降落，第一次感觉到姿态调整算法是有用的！修飞机的技术也长进了不少，飞机实在是很脆弱。 总之过程很曲折，但队友很靠谱，希望有机会还能一起合作~
* **张彦雯**：暑假前每天上课所学到的东西其实在放完假之后已经差不多都忘记了。而最后的项目完成基本上都是在开学后这两周时间内。这两个星期根本没有把心态调整过来，以至于后来一说到飞机就非常地烦躁。本来我们是想只做抛飞一个功能的，可是耐不住身边的同学们都那么优秀，都做了好几个功能，所以我们也只好继续增加功能。幸好之前有设想过如何实现，改起代码来比较快，只是在调试花费了不少时间。为此我们带着“充电两小时，飞行十分钟”的飞机进行了数次野外生存游戏。不仅我们的飞机进过水、摔断桨、碰断了电池的线等等等等，还有我们的人也在这个过程中被飞机划到、被蚊子肆虐地咬，可以说是同生共死了。在某一次撞机之后我们的飞机彻底报销了，所以之后只能跟别人借了飞机继续来做。还有我们的遥控器的键也坏了，不能做一键起飞，也只能用机巧的办法来解决。虽然最后我们飞机的视频质量参差不齐，但是也可以体现出我们实现的功能还有我们的信念了。这一次实训真的受益良多，就算是结束，也给了我们莫大的感动。
* **周禅城**：周禅城：这次工程实训说实话收获还是挺大的。以前从来没有接触过这种多轴飞行器，只是见过别人玩大疆的精灵，当时就觉得很酷炫。这次工程实训给了我们一个机会设计属于自己的六轴飞行器。实训六天很快就过去了，港真还有点不舍得，很少有这样既能真正掌握知识又轻松愉快的课堂，特别是能有一位逗比的大腿TA，真是很大的一坨猿粪。我们小组每个人都在很认真的学习，好几天验收任务比较赶（有一天应该是获取三轴陀螺仪和加速度计数据来完成姿态解算），中午都不回去，在桌子上趴一下就继续干。在TA的强力助攻下，我们应该算比较好地完成了验收任务。最后一天放飞机是真的欢乐，飞行器在各个没有飞行驾照的老司机的操作下，花式翻滚、撞墙。。。。。项目我们选择做的是抛飞和一键起飞。做抛飞的原因吧，一来这个比较酷炫（看别人的视频是真的帅），二来我们认为这个比较有挑战性，一键起飞的话应该算是必须实现的基本功能。事实证明，抛飞的确有比较有挑战性，首先代码就有一定难度，最难的是调试，无数次飞机啪的一声摔到地上，摔断桨摔坏电机那是家常便饭，还试过把飞机的脑子摔出来和摔烂了开关（现在开飞机都要用牙签），修飞机都修到绝望，所以总结一句：辣鸡飞行器。。。。。做的功能虽然不多，但是效果还好，重要的是抛飞真的不好做（拍完视频飞机已经快散架了。。。。。）最后谢谢TA帮助我们圆满完成这次实训！十分感谢！
